<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë‘ì«€ì¿  ë‹¤ë§ˆê³ ì¹˜ v3.0</title>
    <style>
        body { background: #e9e9e9; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: 'Courier New', monospace; }
        #device { background: #333; padding: 25px; border-radius: 45px; box-shadow: 0 10px 0 #111; width: 300px; text-align: center; position: relative; }
        
        /* ì•¡ì • í™”ë©´ */
        #screen { 
            background: #9dbb94; width: 250px; height: 300px; margin: 0 auto;
            border: 6px solid #222; position: relative; overflow: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: space-between;
        }

        /* ìºë¦­í„° ìŠ¤í”„ë¼ì´íŠ¸ (6ë¶„í•  ì‹œíŠ¸ ê¸°ì¤€) */
        #character {
            width: 150px; height: 150px;
            background-image: url('ì—¬ê¸°ì—_ë§ˆì§€ë§‰_ì´ë¯¸ì§€_ì£¼ì†Œ_ë„£ê¸°'); 
            background-size: 300px 450px; /* 2ì—´ 3í–‰ ì‹œíŠ¸ */
            background-repeat: no-repeat;
            image-rendering: pixelated;
            margin-top: 40px;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ ìœ„ì¹˜ ì„¤ì • (2x3 ì‹œíŠ¸) */
        .state-idle { background-position: 0 0; }           /* IDLE */
        .state-eating { background-position: -150px 0; }    /* EATING */
        .state-sad { background-position: 0 -300px; }       /* SAD */
        .state-sleep { background-position: -150px -300px; } /* SLEEPING */

        #stats { padding: 10px; font-weight: bold; font-size: 14px; background: rgba(0,0,0,0.1); width: 100%; box-sizing: border-box; }
        .buttons { margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button { padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; background: #eee; box-shadow: 0 4px 0 #bbb; }
        button:active { transform: translateY(2px); box-shadow: 0 2px 0 #bbb; }
        
        #rank-ui { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); color: white; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }
    </style>
</head>
<body>

<div id="device">
    <div id="screen">
        <div id="rank-ui">
            <h3>BEST RECORD</h3>
            <h2 id="best-val">0</h2>
            <button onclick="toggleRank()">CLOSE</button>
        </div>
        <div id="stats">ğŸª <span id="h-val">100</span> | ğŸ† <span id="s-val">0</span></div>
        <div id="character" class="state-idle"></div>
        <div id="msg" style="padding-bottom: 10px; font-size: 12px;">ì«€ë“ì«€ë“...</div>
    </div>

    <div class="buttons">
        <button onclick="feed()" style="background: #ffd700;">FEED</button>
        <button onclick="toggleRank()">RANK</button>
        <button onclick="location.reload()" style="grid-column: span 2; background: #ff6b6b; color: white;">RESET</button>
    </div>
</div>

<script>
    let hunger = 100;
    let score = 0;
    let isGameOver = false;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    // 8ë¹„íŠ¸ ì‚¬ìš´ë“œ ì¬ìƒ
    function beep(freq, duration, type) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type || 'square';
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    const loop = setInterval(() => {
        if (!isGameOver) {
            hunger -= 2;
            score += 5;
            updateUI();
        }
    }, 1500);

    function updateUI() {
        document.getElementById('h-val').innerText = hunger;
        document.getElementById('s-val').innerText = score;
        const char = document.getElementById('character');
        const msg = document.getElementById('msg');

        if (hunger <= 0) {
            gameOver();
        } else if (hunger < 30) {
            char.className = 'state-sad';
            msg.innerText = "ë°°ê³ íŒŒì„œ ìš¸ê³ ìˆì–´ìš”!";
        } else {
            char.className = 'state-idle';
            msg.innerText = "ì«€ë“í•˜ê²Œ ëŒ€ê¸° ì¤‘";
        }
    }

    function feed() {
        if (isGameOver) return;
        beep(500, 0.1);
        hunger = Math.min(100, hunger + 20);
        document.getElementById('character').className = 'state-eating';
        document.getElementById('msg').innerText = "ì™€êµ¬ì™€êµ¬! ë§›ìˆë‹¤!";
        setTimeout(updateUI, 1000);
    }

    function toggleRank() {
        beep(800, 0.05, 'sine');
        const best = localStorage.getItem('dooBest') || 0;
        document.getElementById('best-val').innerText = best;
        const ui = document.getElementById('rank-ui');
        ui.style.display = (ui.style.display === 'flex') ? 'none' : 'flex';
    }

    function gameOver() {
        isGameOver = true;
        clearInterval(loop);
        beep(200, 0.5, 'sawtooth');
        document.getElementById('character').className = 'state-sleep';
        document.getElementById('msg').innerText = "ëˆ…ëˆ…í•´ì ¸ì„œ ì ë“¤ì—ˆìŠµë‹ˆë‹¤...";
        const best = localStorage.getItem('dooBest') || 0;
        if (score > best) localStorage.setItem('dooBest', score);
    }
</script>
</body>
</html>
